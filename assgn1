import mysql.connector

conn = mysql.connector.connect(
    host="localhost",
    user="root",
    password="password",
    database="employees"
)

cursor = conn.cursor(dictionary=True)

def fetch_large_data(query, chunk_size=10000):
   
    cursor.execute(query)

    while True:
        rows = cursor.fetchmany(chunk_size)
        if not rows:
            break
        for row in rows:
            yield row

query = "SELECT count(emp_no) FROM employees "

for row in fetch_large_data(query):
    print(row) 
cursor.close()
conn.close()